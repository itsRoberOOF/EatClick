#:kivy 1.10
#-*- coding: utf-8 -*-

#Ventanas declaradas para trabajar a lo largo del código
#:import Factory kivy.factory.Factory
WindowManager:
	FirstWindow:
        name: "first"
	SecondWindow:
        name: "second"
    ThirdWindow:
        name: "third"
    FourthWindow:
        name: "fourth"
    FifthWindow:
        name: "fifth"

#Portada

<FirstWindow>:
    #Colores
	canvas.before:
		Color:
			rgba: (6/255, 52/255, 91/255, 1)
					
		Rectangle:
			pos: self.pos
			size: self.size

	name: "first"
    id: layout
    
    BoxLayout:
        spacing: 20
        padding: [10, 50, 10, 60]  # [izquierda, arriba, derecha, abajo]
        orientation: 'vertical'

        Image:
			source: "Loguito.png"
			size_hint: (1, None)  # Ocupa el 100% del ancho y altura automática
            height: 300  # Altura fija
            allow_stretch: True  # Permitir que la imagen se estire
            keep_ratio: True  # Mantener la proporción original de la imagen

        Label:
            text: "Bienvenido"
            size_hint_y: None
            height: dp(25)
            font_size: 28
            bold: True
        
        Label:
            text: "Ingresa un nombre para tu orden"
            size_hint_y: None
            height: dp(18)
            font_size: 18
            bold: False
        
        TextInput:  # Campo de entrada
            id: nombre_input
            multiline: False  # Solo una línea de texto
            size_hint_y: None  # Controlar el tamaño en la dirección y
            height: 45  # Altura fija
            background_color: (16/255, 67/255, 110/255, 1)  # Color de fondo (RGBA)
            foreground_color: (1, 1, 1, 1)  # Color del texto (RGBA)
            font_size: 18  # Tamaño de letra
            padding: [10, 10, 10, 10]  # Padding interno del TextInput
            size_hint_x: 0.6
            pos_hint: {"center_x": 0.5}

        Button:
            text: "Continuar"
            bold: True
            size_hint_x: 0.4
            pos_hint: {"center_x": 0.5}
            size_hint_y: None
            height: 50
            font_size: 18
            on_release: 
                root.enviar_nombre()
            background_normal: "Boton_rojo.png"
            background_down: "Boton_rojo_presionado.png"
            canvas.before:
                # Dibuja un rectángulo con esquinas redondeadas
                Color:
                    rgba: self.background_color
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [20]  # Ajusta el radio para los bordes redondeados
<SecondWindow>:
    canvas.before:
        Color:
            rgba: (6/255, 52/255, 91/255, 1)  # Color de fondo azul oscuro
        Rectangle:
            pos: self.pos
            size: self.size

    name: "second"
    BoxLayout:
        orientation: 'vertical'
        
        BoxLayout: 
            orientation: 'horizontal'
            size_hint_y: 0.15  # Altura del contenedor
            
            BoxLayout:
                orientation: 'vertical'
                size_hint_x: 0.85
                Label:
                    id: cliente_label
                    text: "Cliente:"
                    font_size: 20
                    bold: True
                    halign: 'left'  
                    valign: 'bottom'  
                    text_size: self.size 
                    padding_x: dp(20) 
                    foreground_color: (255, 255, 255, 1)
                
                Label:
                    id: nombre_label
                    text: ""
                    font_size: 18
                    halign: 'left'  
                    valign: 'top'  
                    text_size: self.size 
                    padding_x: dp(20) 
                    foreground_color: (255, 255, 255, 1)
            
            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Carrito.png"
                background_down: "Carrito_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'fifth'
            
            Widget:
                size_hint: (None, None)
                width: 20
        
        ScrollView:  # Sección para el ScrollView
            do_scroll_x: False
            bar_width: 0
            scroll_type: ['content']
            GridLayout:
                id: layout
                cols: 2
                size_hint_y: None
                height: self.minimum_height
                row_default_height: dp(150)
                row_force_default: True
                spacing: dp(20)
                padding: [20, 10, 20, 0]

        Label:  # Título "Nota"
            id: nota_label
            text: "Nota:"
            font_size: 20
            size_hint_y: 0.1
            bold: True
            halign: 'left'  
            valign: 'bottom'  
            text_size: self.size 
            padding: [20, 0, 20, 5]
            foreground_color: (255, 255, 255, 1)   
        
        Label:  # Mensaje descriptivo
            id: msj_label
            text: "Escoge la categoría o tipo de producto que deseas agregar a tu orden actual."
            font_size: 18
            size_hint_y: 0.2
            halign: 'left'  
            valign: 'top'  
            text_size: self.size 
            padding: [20, 0, 20, 20]
            foreground_color: (255, 255, 255, 1)

<ThirdWindow>:
    name: "third"
    canvas.before:
        Color:
            rgba: (6/255, 52/255, 91/255, 1)  # Color de fondo azul oscuro
        Rectangle:
            pos: self.pos
            size: self.size    

    BoxLayout:
        orientation: 'vertical'

        BoxLayout: 
            orientation: 'horizontal'
            size_hint_y: 0.15  # Altura del contenedor
            
            Widget:
                size_hint: (None, None)
                width: 20

            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Atras.png"
                background_down: "Atras_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'second'

            BoxLayout:
                orientation: 'vertical'
                size_hint_x: 0.85
                Label:
                    id: cliente_label
                    text: "Categoría:"
                    font_size: 20
                    bold: True
                    halign: 'center'  
                    valign: 'bottom'  
                    text_size: self.size 
                    padding_x: dp(10) 
                    foreground_color: (255, 255, 255, 1)
                
                Label:
                    id: categoria_label
                    text: ""
                    font_size: 18
                    halign: 'center'  
                    valign: 'top'  
                    text_size: self.size 
                    padding_x: dp(10) 
                    foreground_color: (255, 255, 255, 1)
            
            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Carrito.png"
                background_down: "Carrito_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'fifth'
            
            Widget:
                size_hint: (None, None)
                width: 20
        ScrollView:  # Sección para el ScrollView
            bar_width: 0
            scroll_type: ['content']
            GridLayout:
                id: layout
                cols: 2
                size_hint_y: None
                height: self.minimum_height
                row_default_height: dp(150)
                row_force_default: True
                spacing: dp(20)
                padding: [20, 10, 20, 0]

        Label:  # Título "Nota"
            id: nota_label
            text: "Nota:"
            font_size: '20sp'
            size_hint_y: 0.1
            bold: True
            halign: 'left'  
            valign: 'bottom'  
            text_size: self.size 
            padding: [20, 0, 20, 5]
            foreground_color: (255, 255, 255, 1)   
        
        Label:  # Mensaje descriptivo
            id: msj_label
            text: "Selecciona el producto que deseas agregar a tu orden."
            font_size: '18sp'
            size_hint_y: 0.2
            halign: 'left'  
            valign: 'top'  
            text_size: self.size 
            padding: [20, 0, 20, 20]
            foreground_color: (255, 255, 255, 1)

<FourthWindow>:
    name: "fourth"
    canvas.before:
        Color:
            rgba: (6/255, 52/255, 91/255, 1)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        id: layout

        BoxLayout: 
            orientation: 'horizontal'
            size_hint_y: 0.15
            
            Widget:
                size_hint: (None, None)
                width: 20

            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Atras.png"
                background_down: "Atras_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'second'

            Label:
                id: detalle_label
                size_hint_x: 0.85
                text: "Detalles del producto:"
                font_size: 20
                bold: True
                halign: 'center'  
                valign: 'middle'  
                text_size: self.size 
                padding_x: dp(10) 
                foreground_color: (255, 255, 255, 1)
            
            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Carrito.png"
                background_down: "Carrito_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'fifth'
            
            Widget:
                size_hint: (None, None)
                width: 20
    
        Widget:
            size_hint_y: None
            height: 10

        BoxLayout:
            orientation: "vertical"
            size_hint_x: 0.9
            spacing: dp(10)  # Añade un pequeño espacio entre los elementos (puedes ajustarlo)
            pos_hint: {"center_x": 0.5, "top": 1}

            canvas.before:
                Color:
                    rgba: (16/255, 67/255, 110/255, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size

            Label:
                id: texto_producto
                text: ""
                font_size: 20
                bold: True
                halign: 'center'
                valign: 'middle'
                size_hint_y: None
                height: dp(30)

            Image:
                id: imagen_producto
                source: "Default.png"
                size_hint: (0.9, None) 
                height: dp(200) 
                allow_stretch: True
                pos_hint: {"center_x": 0.5}

            Label:
                id: texto_descripcion
                text: ""
                font_size: 18
                halign: 'left'
                valign: 'top'
                size_hint_y: None 
                height: dp(40)
                size_hint_x: 0.85
                text_size: self.size
                pos_hint: {"center_x": 0.5}

            Widget:
                size_hint_y: None
                height: dp(70) 

        GridLayout:
            cols: 4
            size_hint_y: 0.2
            size_hint_x: 0.9
            row_default_height: dp(35)
            row_force_default: True
            spacing: dp(5)
            height: self.minimum_height  # Ajusta la altura al contenido
            padding: [0, 20, 0, 20]
            pos_hint: {"center_x": 0.5}
            Button:
                id: boton_enviar
                text: "Agregar a la orden"
                bold: True 
                size_hint: (None, None)
                height: 40
                size_hint_x: 2
                background_normal: "Boton_rojo.png"
                background_down: "Boton_rojo_presionado.png"
                font_size: 18
                
            Button:
                text: "-"
                bold: True 
                size_hint: (None, None)
                height: 40
                font_size: 24
                size_hint_x: 0.5
                background_normal: "Boton_azul.png"
                background_down: "Boton_azul_presionado.png"
                on_release: 
                    root.botones_cantidad("resta")
            TextInput:
                id: input_cantidad
                text: "1"
                font_size: 20
                halign: "center"
                valign: "middle"
                color: 0, 0, 0, 1
                bold: True 
                size_hint: (None, None)
                height: 40
                size_hint_x: 0.5
                background_color: (1, 1, 1, 1)
            Button:
                text: "+"
                bold: True 
                font_size: 20
                size_hint: (None, None)
                height: 40
                size_hint_x: 0.5
                background_normal: "Boton_verde.png"
                background_down: "Boton_verde_presionado.png"
                on_release: 
                    root.botones_cantidad("suma")
<FifthWindow>:
    name: "fifth"
    canvas.before:
        Color:
            rgba: (6/255, 52/255, 91/255, 1)  # Color de fondo azul oscuro
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        BoxLayout: 
            orientation: 'horizontal'
            size_hint_y: 0.15
            
            Widget:
                size_hint: (None, None)
                width: 20

            Button:
                size_hint: (None, None)
                height: 50
                width: 50
                background_normal: "Atras.png"
                background_down: "Atras_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.manager.current = 'second'

            BoxLayout:
                size_hint_x: 0.5
                orientation: 'vertical'
                pos_hint: {"center_y": 0.45}
                Label:
                    id: detalles_label
                    text: "Detalles"
                    font_size: 20
                    bold: True
                    halign: 'left'  
                    valign: 'bottom'  
                    text_size: self.size 
                    padding_x: dp(20) 
                    foreground_color: (255, 255, 255, 1)
                
                Label:
                    id: factura_label
                    text: "De la orden"
                    font_size: 18
                    halign: 'left'  
                    valign: 'top'  
                    text_size: self.size 
                    padding_x: dp(20) 
                    foreground_color: (255, 255, 255, 1)

            Button:
                size_hint: (None, None)
                height: 50
                width: 150
                text: "Generar factura"
                bold: True
                font_size: 18
                background_normal: "Boton_verde.png"
                background_down: "Boton_verde_presionado.png"
                halign: "center"
                valign: "top"
                border: [0, 0, 0, 0]
                allow_stretch: False
                keep_ratio: True
                pos_hint: {"center_y": 0.45}
                on_press: root.generar_factura()
            
            Widget:
                size_hint: (None, None)
                width: 20
        
        ScrollView:  
            bar_width: 0
            scroll_type: ['content']
            size_hint_y: 1
            GridLayout:
                id: layout
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                row_default_height: 80
                row_force_default: True
                spacing: dp(20)
                padding: [20, 10, 20, 10]

        BoxLayout:
            size_hint_y: 0.1
            halign: 'right'
            orientation: 'horizontal'
            Widget:
                size_hint_x: 0.65
            Label:
                id: total
                size_hint_x: 0.15
                text: "Total:"
                font_size: 18
                padding_x: dp(20) 
                foreground_color: (255, 255, 255, 1)
                bold: True
            Label:
                id: precio_total
                size_hint_x: 0.2
                text: "$0.00"
                font_size: 18
                text_size: self.size
                halign: 'right'
                valign: 'middle'
                foreground_color: (255, 255, 255, 1)
            Widget:
                size_hint: (None, None)
                width: 20
